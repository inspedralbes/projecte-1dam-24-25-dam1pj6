<%- include('../partials/header', { title: 'Crear Incidència' }) %>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<div class="container mt-5">
  <div class="card shadow-sm border-0 rounded-4">
    <div class="card-body p-4">
      <h3 class="text-center mb-4">
        <i class="bi bi-bug-fill text-primary me-2"></i>Crear Nova Incidència
      </h3>

      <form action="/incidencies/create" method="POST" class="needs-validation" novalidate>
        <div class="mb-3">
          <label for="nom" class="form-label fw-semibold">Nom</label>
          <input type="text" class="form-control" id="nom" name="nom" placeholder="Ex: Impressora no funciona" required>
        </div>

        <div class="mb-3">
          <label for="departament_id" class="form-label fw-semibold">Departament</label>
          <select class="form-select" id="departament_id" name="departament_id" required>
            <option selected disabled value="">Selecciona un departament</option>
            <% departamentos.forEach(departamento => { %>
              <option value="<%= departamento.id %>"><%= departamento.nom %></option>
            <% }) %>
          </select>
        </div>

        <div class="mb-3">
        <label for="tipus_id" class="form-label fw-semibold">Tipus</label>
        <select class="form-select" id="tipus_id" name="tipus_id" required>
          <option selected disabled value="">Selecciona un tipus</option>
          <% tipus.forEach(tipo => { %>
            <option value="<%= tipo.id %>"><%= tipo.nom %></option>
          <% }) %>
        </select>
         </div>


        <div class="mb-3">
          <label for="descripcio" class="form-label fw-semibold">Descripció</label>
          <textarea class="form-control" id="descripcio" name="descripcio" rows="4" placeholder="Explica breument el problema" required></textarea>
        </div>

        <button type="submit" class="btn btn-outline-primary w-100">
          <i class="bi bi-check-circle me-1"></i> Crear Incidència
        </button>
      </form>
    </div>
  </div>
</div>

<% if (successMessage) { %>
  <script>
    Swal.fire({
      title: '¡Incidència Creada!',
      text: '<%= successMessage %>',
      icon: 'success',
      confirmButtonText: 'Cerrar',
      confirmButtonColor: '#3085d6'
    });
  </script>
<% } %>

<%- include('../partials/footer') %>
