<%- include('../partials/header', { title: 'Editar Incidència' }) %>

<div class="container mt-5">
  <div class="card shadow-lg border-0 rounded-3">
    <div class="card-body p-5">
      <h3 class="card-title text-center text-uppercase mb-4">Editar Incidència</h3>
      
      <form action="/tecnic/incidencies/<%= incidencia.id %>/update" method="POST">
        
        <div class="mb-4">
          <label for="nom" class="form-label fw-bold">Nom de la incidència</label>
          <input type="text" class="form-control form-control-lg" id="nom" name="nom" value="<%= incidencia.nom %>" required>
        </div>
        
        <div class="mb-4">
          <label for="departament_id" class="form-label fw-bold">Departament</label>
          <select class="form-select form-select-lg" id="departament_id" name="departament_id" required>
            <% departamentos.forEach(departamento => { %>
              <option value="<%= departamento.id %>" <%= departamento.id === incidencia.departament_id ? 'selected' : '' %> >
                <%= departamento.nom %>
              </option>
            <% }) %>
          </select>
        </div>
        
        <div class="mb-4">
          <label for="tipus" class="form-label fw-bold">Tipus d'incidència</label>
          <input type="text" class="form-control form-control-lg" id="tipus" name="tipus" value="<%= incidencia.tipus %>" required>
        </div>

        <div class="mb-4">
          <label for="descripcio" class="form-label fw-bold">Descripció</label>
          <textarea class="form-control form-control-lg" id="descripcio" name="descripcio" rows="5" required><%= incidencia.descripcio %></textarea>
        </div>

        <div class="mb-4">
          <label for="prioritat_id" class="form-label fw-bold">Prioritat</label>
          <select class="form-select form-select-lg" id="prioritat_id" name="prioritat_id" required>
            <% prioritats.forEach(prioritat => { %>
              <option value="<%= prioritat.id %>" <%= prioritat.id === incidencia.prioritat_id ? 'selected' : '' %> >
                <%= prioritat.nom %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="mb-4">
          <label for="estat_id" class="form-label fw-bold">Estat</label>
          <select class="form-select form-select-lg" id="estat_id" name="estat_id" required>
            <% estat.forEach(status => { %>
              <option value="<%= status.id %>" <%= status.id === incidencia.estat_id ? 'selected' : '' %> >
                <%= status.nom %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="mb-4">
          <label for="dataresolucio" class="form-label fw-bold">Data de Resolució</label>
          <input type="date" class="form-control form-control-lg" id="dataresolucio" name="dataresolucio" value="<%= incidencia.dataresolucio %>">

        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-primary btn-lg w-100">Actualizar Incidència</button>
        </div>
      </form>

      <div class="mt-4 text-center">
        <a href="/tecnic/incidencies?tecnic_id=<%= incidencia.tecnic_id %>" class="btn btn-link text-muted">Tornar a la llista d'incidències</a>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>


<%- include('../partials/footer') %>
