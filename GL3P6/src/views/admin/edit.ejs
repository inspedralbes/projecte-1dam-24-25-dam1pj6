<%- include('../partials/header', { title: 'Editar Incidència' }) %>

<style>
  body {
    background-color: #121212;
    color: #e0e0e0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  .card {
    background-color: #555;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
  }

  .card-title {
    color: #90caf9;
  }

  .form-label {
    color: #e0e0e0;
  }

  .form-control {
    background-color: #2c2c2c;
    color: #ffffff;
    border: 1px solid #444;
  }

  .form-control:focus {
    color: #000000;
    border-color: #90caf9;
    box-shadow: 0 0 5px #90caf980;
  }

  .btn-primary {
    background: linear-gradient(135deg, #00c6ff, #0072ff);
    border: none;
    font-weight: bold;
    transition: background-color 0.3s ease; 
  }

  .btn-primary:hover {
    background: linear-gradient(135deg, #0072ff, #00c6ff);
    box-shadow: 0 0 10px #00c6ff90;
  }

  .btn-link {
    color: #90caf9;
    text-decoration: underline;
  }

  .btn-link:hover {
    color: #64b5f6;
  }
</style>

<div class="container mt-5">
  <div class="card shadow-sm">
    <div class="card-body">
      <h1 class="card-title text-center">Editar Incidència</h1>
      <form action="/admin/<%= incidencia.id %>/update" method="POST">
        <div class="mb-3">
          <label for="nom" class="form-label">Nom</label>
          <input type="text" class="form-control" id="nom" name="nom" value="<%= incidencia.nom %>" required>
        </div>

        <div class="mb-3">
          <label for="departament_id" class="form-label">Departament</label>
          <select class="form-control" id="departament_id" name="departament_id" required>
            <% departamentos.forEach(departamento => { %>
              <option value="<%= departamento.id %>" <%= departamento.id === incidencia.departament_id ? 'selected' : '' %>>
                <%= departamento.nom %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="mb-3">
          <label for="tipus" class="form-label">Tipus</label>
          <input type="text" class="form-control" id="tipus" name="tipus" value="<%= incidencia.tipus %>" required>
        </div>

        <div class="mb-3">
          <label for="descripcio" class="form-label">Descripció</label>
          <textarea class="form-control" id="descripcio" name="descripcio" rows="4" required><%= incidencia.descripcio %></textarea>
        </div>

        <div class="mb-3">
          <label for="estat_id" class="form-label">Estat</label>
          <select class="form-control" id="estat_id" name="estat_id" required>
            <% estats.forEach(estat => { %>
              <option value="<%= estat.id %>" <%= estat.id === incidencia.estat_id ? 'selected' : '' %>>
                <%= estat.nom %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="mb-3">
          <label for="tecnic_id" class="form-label">Assignació de tècnic</label>
          <select class="form-control" id="tecnic_id" name="tecnic_id" required>
            <% tecnics.forEach(tecnic => { %>
              <option value="<%= tecnic.id %>" <%= tecnic.id === incidencia.tecnic_id ? 'selected' : '' %>>
                <%= tecnic.nom %>
              </option>
            <% }) %>
          </select>
        </div>
        
        <div class="mb-3">
          <label for="dataresolucio" class="form-label">Data resolució</label>
          <input type="date" class="form-control" id="dataresolucio" name="dataresolucio"
                 value="<%= incidencia.dataresolucio ? new Date(incidencia.dataresolucio).toISOString().split('T')[0] : '' %>">
        </div>

        <button type="submit" class="btn btn-primary w-100">Actualitzar Incidència</button>
      </form>

      <div class="mt-3 text-center">
        <a href="/admin" class="btn btn-link">Tornar a la llista d'incidències</a>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
