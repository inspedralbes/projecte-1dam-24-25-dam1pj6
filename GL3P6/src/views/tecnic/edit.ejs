<%- include('../partials/header', { title: 'Editar Incidència' }) %>

<div class="container mt-4">
  <h3 class="text-center mb-4" style="font-weight: normal;">Editar Incidència</h3>

  <form action="/tecnic/incidencies/<%= incidencia.id %>/update" method="POST">
    <div class="mb-3">
      <label for="estat_id" class="form-label">Estat</label>
      <select class="form-control" id="estat_id" name="estat_id">
        <% estats.forEach(estat => { %>
          <option value="<%= estat.id %>" <%= estat.id === incidencia.estat_id ? 'selected' : '' %>>
            <%= estat.nom %>
          </option>
        <% }) %>
      </select>
    </div>

    <div class="mb-3">
      <label for="dataresolucio" class="form-label">Data de Resolució</label>
      <input type="datetime-local" class="form-control" id="dataresolucio" name="dataresolucio"
             value="<%= incidencia.dataresolucio ? incidencia.dataresolucio.toISOString().slice(0, 16) : '' %>">
    </div>

    <div class="mb-3">
      <label for="prioritat_id" class="form-label">Prioritat</label>
      <select class="form-control" id="prioritat_id" name="prioritat_id">
        <% prioritats.forEach(p => { %>
          <option value="<%= p.id %>" <%= p.id === incidencia.prioritat_id ? 'selected' : '' %>>
            <%= p.nom %>
          </option>
        <% }) %>
      </select>
    </div>

    <div class="form-check mb-3">
      <input type="checkbox" class="form-check-input" id="acceptat" name="acceptat" value="true"
             <%= incidencia.acceptat ? 'checked' : '' %>>
      <label class="form-check-label" for="acceptat">Acceptar Incidència</label>
    </div>

    <button type="submit" class="btn btn-primary w-100">Actualizar</button>
  </form>

  <div class="mt-3 text-center">
    <a href="/tecnic/incidencies?tecnic_id=<%= incidencia.tecnic_id %>" class="btn btn-link">Tornar</a>
  </div>
</div>

<%- include('../partials/footer') %>
